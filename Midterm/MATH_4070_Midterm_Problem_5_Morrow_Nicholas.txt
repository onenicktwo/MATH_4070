
% MATH 4070
% Midterm
% Problem 5
% By Nicholas Morrow

load('Midterm_Data_2.mat')
B

B =

    2.8748    0.9511    0.3105    1.1141    1.0610    0.3330   -0.2573   -1.5491    0.9584   -0.5025
   -1.2610    2.1756   -0.3760   -1.2419   -0.4335    4.0268   -1.3972    0.7081   -1.0077    0.5020
    1.2976    1.9599    4.1357    0.6621   -2.3253    2.1079    1.0343   -0.1749   -2.1598   -0.3944
   -2.9669    1.5378   -1.2025    4.7206    0.1558    1.8950   -1.3639   -0.9742   -0.8610   -1.7915
   -2.0034    1.0551    0.1872   -0.9041    2.8294   -1.2603   -2.2753   -1.7490   -2.5889   -1.8719
   -0.4604   -3.1681   -1.4272   -0.4016   -0.2001    1.0232   -0.7449   -0.7173   -0.9938    1.4593
    1.0301    1.8375   -2.4514    2.5420    1.1968   -0.5720    1.8734   -0.8710    0.0204    0.8138
   -0.1732   -0.0096    1.4866    4.2586    2.2080    1.9830    1.6110    4.1668    0.0503   -0.1915
   -1.0168    0.7558    1.9525    0.6592    2.0820    1.5745   -0.7037   -0.6773    2.3936   -0.7402
    1.3646   -1.2161   -0.3824    2.4329    1.2441   -0.1919    0.9763   -1.4296    0.4228    3.1187


% Decompose B into Symmetric Part: S = (B + B')/2 and Skew-Symmetric Part: K = (B - B')/2 such that B = S + K.
% Now, Q(x) = x' * (S+K) * x = x'*S*x + x'*K*x. We can now analyze both parts.
% x'*K*x is scalar. So, x'*K*x = (x'*K*x)' ==> x'*K*x = x'*(-K)*x, thus x'*K*x = 0 for all vectors x.
% So, Q(x) = x' * S * x. Thus, it only relies on the symmetric part of B.
S = (B + B') / 2

S =

    2.8748   -0.1549    0.8040   -0.9264   -0.4712   -0.0637    0.3864   -0.8612   -0.0292    0.4311
   -0.1549    2.1756    0.7919    0.1479    0.3108    0.4293    0.2202    0.3492   -0.1259   -0.3570
    0.8040    0.7919    4.1357   -0.2702   -1.0691    0.3403   -0.7086    0.6559   -0.1037   -0.3884
   -0.9264    0.1479   -0.2702    4.7206   -0.3741    0.7467    0.5891    1.6422   -0.1009    0.3207
   -0.4712    0.3108   -1.0691   -0.3741    2.8294   -0.7302   -0.5393    0.2295   -0.2535   -0.3139
   -0.0637    0.4293    0.3403    0.7467   -0.7302    1.0232   -0.6584    0.6329    0.2904    0.6337
    0.3864    0.2202   -0.7086    0.5891   -0.5393   -0.6584    1.8734    0.3700   -0.3417    0.8950
   -0.8612    0.3492    0.6559    1.6422    0.2295    0.6329    0.3700    4.1668   -0.3135   -0.8106
   -0.0292   -0.1259   -0.1037   -0.1009   -0.2535    0.2904   -0.3417   -0.3135    2.3936   -0.1587
    0.4311   -0.3570   -0.3884    0.3207   -0.3139    0.6337    0.8950   -0.8106   -0.1587    3.1187


% If S has at least one negative eigenvalue, S is indefinite, and x'*S*x can be negative.
% Calculate the eigenvalues of the symmetric matrix S.
eigenvalues = eig(S)

eigenvalues =

   -0.3677
    1.2650
    1.8947
    2.0252
    2.1026
    2.4152
    3.0444
    4.6875
    5.4238
    6.8211


% Find the minimum eigenvalue to find negative values.
[min_eig, min_idx] = min(eigenvalues)

min_eig =

   -0.3677


min_idx =

     1


% This eigenvalue is negative, so Q(x) could be negative. We can check this by finding the eigenvector x for this value.
[V, D] = eig(S)

V =

    0.0917    0.3250   -0.5353    0.4427    0.0677   -0.2606   -0.2996    0.3057   -0.2517    0.2906
    0.2549    0.2361    0.4420    0.5191    0.1193    0.5493   -0.1927   -0.1066   -0.1941   -0.1108
   -0.1591   -0.4577   -0.1189   -0.1596    0.0529    0.2019   -0.0380    0.0544   -0.8214   -0.0531
    0.0568   -0.0743   -0.3263    0.1041    0.4587    0.1237    0.1905    0.3286    0.1748   -0.6881
   -0.2825   -0.2413   -0.4964    0.1771   -0.1138    0.4080   -0.2919   -0.4786    0.2995    0.0290
   -0.6716    0.5510   -0.0171   -0.0402   -0.2848    0.2232    0.2195    0.1614   -0.1196   -0.1551
   -0.5061   -0.3566    0.3814    0.3101    0.0541   -0.2670   -0.4161    0.3088    0.1637   -0.0754
    0.1991    0.0777   -0.0327    0.0224   -0.5356   -0.3350   -0.2968   -0.2293   -0.1596   -0.6226
    0.0287   -0.3192   -0.0304    0.5826   -0.3652   -0.0924    0.6418    0.0010   -0.0158    0.0535
    0.2660   -0.1636   -0.0577   -0.1708   -0.5008    0.4074   -0.1699    0.6174    0.1928    0.0773


D =

   -0.3677         0         0         0         0         0         0         0         0         0
         0    1.2650         0         0         0         0         0         0         0         0
         0         0    1.8947         0         0         0         0         0         0         0
         0         0         0    2.0252         0         0         0         0         0         0
         0         0         0         0    2.1026         0         0         0         0         0
         0         0         0         0         0    2.4152         0         0         0         0
         0         0         0         0         0         0    3.0444         0         0         0
         0         0         0         0         0         0         0    4.6875         0         0
         0         0         0         0         0         0         0         0    5.4238         0
         0         0         0         0         0         0         0         0         0    6.8211

x = V(:, min_idx)

x =

    0.0917
    0.2549
   -0.1591
    0.0568
   -0.2825
   -0.6716
   -0.5061
    0.1991
    0.0287
    0.2660


% Calculate Q(x) to verify
Q_ans = x' * B * x

Q_ans =

   -0.3677


% This is negative, thus we found an x where Q(x) is negative.

diary off;
