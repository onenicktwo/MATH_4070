
% MATH 4070
% HW 3
% Problem 5
% By Nicholas Morrow

% Time t in seconds
t = (0:12)';

% Position y in feet
y = [0; 8.8; 29.9; 62.0; 104.7; 159.1; 222.0; 294.5; 380.4; 471.1; 571.7; 686.8; 809.2];

% Part (a)

% Construct the matrix A. Each column corresponds to a power of t.
A = [ones(size(t)), t, t.^2, t.^3]

A =

           1           0           0           0
           1           1           1           1
           1           2           4           8
           1           3           9          27
           1           4          16          64
           1           5          25         125
           1           6          36         216
           1           7          49         343
           1           8          64         512
           1           9          81         729
           1          10         100        1000
           1          11         121        1331
           1          12         144        1728


% Make the norm equation: A'*A * b = A'*y
% First, the gram matrix G = A' * A
G = A' * A

G =

          13          78         650        6084
          78         650        6084       60710
         650        6084       60710      630708
        6084       60710      630708     6735950


% Then, the right hand side equation
b_rhs = A' * y

b_rhs =

   1.0e+06 *

    0.0038
    0.0351
    0.3481
    3.5998


% Solve G * b = b_rhs using Cholesky
% First, find Cholesky factor s.t. G = L' * L
L = chol(G)

L =

   1.0e+03 *

    0.0036    0.0216    0.1803    1.6874
         0    0.0135    0.1619    1.7943
         0         0    0.0447    0.8054
         0         0         0    0.1435


% Then, solve the equation L'Lb = b_rhs
b_chol = L \ (L' \ b_rhs)

b_chol =

   -0.8558
    4.7025
    5.5554
   -0.0274


% Part (b)

% Find QR factorization of A
[Q, R] = qr(A);
Q

Q =

  Columns 1 through 11

   -0.2774   -0.4447    0.4917    0.4599    0.0851    0.0786    0.0273   -0.0508   -0.1378   -0.2156   -0.2660
   -0.2774   -0.3706    0.2458   -0.0000    0.0620    0.1580    0.2311    0.2840    0.3191    0.3388    0.3456
   -0.2774   -0.2965    0.0447   -0.2509   -0.3322   -0.3668   -0.3664   -0.3304   -0.2584   -0.1497   -0.0040
   -0.2774   -0.2224   -0.1117   -0.3345   -0.3385   -0.2028   -0.0401    0.1108    0.2113    0.2227    0.1061
   -0.2774   -0.1482   -0.2235   -0.2927    0.8495   -0.1339   -0.1073   -0.0764   -0.0472   -0.0257   -0.0178
   -0.2774   -0.0741   -0.2905   -0.1672   -0.1434    0.8508   -0.1445   -0.1309   -0.1102   -0.0842   -0.0547
   -0.2774   -0.0000   -0.3129   -0.0000   -0.1158   -0.1448    0.8347   -0.1738   -0.1670   -0.1415   -0.0937
   -0.2774    0.0741   -0.2905    0.1672   -0.0763   -0.1251   -0.1691    0.8000   -0.2094   -0.1893   -0.1311
   -0.2774    0.1482   -0.2235    0.2927   -0.0337   -0.0947   -0.1553   -0.2040    0.7708   -0.2193   -0.1629
   -0.2774    0.2224   -0.1117    0.3345    0.0030   -0.0581   -0.1233   -0.1806   -0.2180    0.7765   -0.1852
   -0.2774    0.2965    0.0447    0.2509    0.0253   -0.0199   -0.0725   -0.1245   -0.1675   -0.1935    0.8058
   -0.2774    0.3706    0.2458    0.0000    0.0241    0.0154   -0.0024   -0.0304   -0.0696   -0.1211   -0.1858
   -0.2774    0.4447    0.4917   -0.4599   -0.0092    0.0433    0.0877    0.1069    0.0840    0.0020   -0.1563

  Columns 12 through 13

   -0.2712   -0.2131
    0.3421    0.3306
    0.1793    0.4007
   -0.1770   -0.6654
   -0.0294   -0.0664
   -0.0233    0.0081
   -0.0204    0.0819
   -0.0267    0.1322
   -0.0483    0.1361
   -0.0911    0.0707
   -0.1613   -0.0868
    0.7351   -0.3592
   -0.4078    0.2305

R

R =

   1.0e+03 *

   -0.0036   -0.0216   -0.1803   -1.6874
         0    0.0135    0.1619    1.7943
         0         0    0.0447    0.8054
         0         0         0   -0.1435
         0         0         0         0
         0         0         0         0
         0         0         0         0
         0         0         0         0
         0         0         0         0
         0         0         0         0
         0         0         0         0
         0         0         0         0
         0         0         0         0


% Least-squares solution to A*b = y is the solution to R*b=Q'*y
b_qr = R \ (Q' * y)

b_qr =

   -0.8558
    4.7025
    5.5554
   -0.0274


% Compare answers
Diff = b_chol - b_qr

Diff =

   1.0e-11 *

    0.1488
   -0.1400
    0.0266
   -0.0014

max_abs_diff = max(abs(Diff))

max_abs_diff =

   1.4885e-12


% This is a very low error, so this b found by QR is the same as the b found by Cholesky

% Part (c)

% The estimated position is est = beta_0 + beta_1*t + beta_2*t^2 + beta_3*t^3 where t = 4.5.
t_est = 4.5;
t_vec = [1, t_est, t_est^2, t_est^3];

% Solve equation for (a) and (b)
est_a = t_vec * b_chol

est_a =

  130.3085

est_b = t_vec * b_qr

est_b =

  130.3085


diary off;
